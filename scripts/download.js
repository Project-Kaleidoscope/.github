/*! KaleidoscopeOS Download Center v1.0.8 | Copyright © 2002-2023 MlgmXyysd, © 2013-2023 MeowCat Studio, © 2020-2023 Meow Mobile All Rights Reserved */
"use strict";console.log("KaleidoscopeOS Download Center v1.0.8");var closeDeviceWindow=function(){$(".panel-select-device").show();$("#device_window").hide();$("#device_window").attr("src","");$("#device_data").html("");history.replaceState(null,null,"?")};const getLogo=function(logo){switch(parseInt(logo.type)){case 0:return'<div class="mdui-list-item-icon mdui-icon brand-icon" style="color: #'+logo.color+';">'+logo.logo+'</div>';case 1:return'<img class="mdui-list-item-icon mdui-icon brand-icon" src="'+logo.logo+'"/>';default:return""}};const getQuery=function(key){let queries=window.location.search;if(queries!==""){if(queries.startsWith("?")){queries=queries.substr(1)}queries=queries.split("&");for(let i=0;i<queries.length;i++){if(queries[i].startsWith(key)){let result=queries[i].startsWith(key+"=")?queries[i].substr(key.length+1):"";return result===""?true:result}}return false}else{return false}};const isDownloadDrawerOpen=function(){return parseInt($("#download-drawer").css("transform").split(",")[4])>=0};const closeDownloadDrawer=function(){if(isDownloadDrawerOpen()){$("#download-drawer")[0].style.transform="translateX(-320px)";$(".drawer-shadow").hide()}};const openDownloadDrawer=function(){if(!isDownloadDrawerOpen()){$("#download-drawer")[0].style.transform="translateX(0)";$(".drawer-shadow").show()}};const toggleDownloadDrawer=function(){if(isDownloadDrawerOpen()){closeDownloadDrawer()}else{openDownloadDrawer()}};const sortObject=function(o){const s={};Object.keys(o).sort((a,b)=>{if(a.startsWith("[END]")&&b.startsWith("[END]")){a=a.replace("[END]","").replace("[END] ","");b=b.replace("[END]","").replace("[END] ","")}else if(a.startsWith("[END]")&&!b.startsWith("[END]")){return 1}else if(!a.startsWith("[END]")&&b.startsWith("[END]")){return-1}else if(a.startsWith("[START]")&&b.startsWith("[START]")){a=a.replace("[START]","").replace("[START] ","");b=b.replace("[START]","").replace("[START] ","")}else if(a.startsWith("[END]")&&!b.startsWith("[START]")){return-1}else if(!a.startsWith("[START]")&&b.startsWith("[START]")){return 1}for(let i=0;i<a.length&&i<b.length;i++){if(a[i]===b[i]){if(i+1===a.length||i+1===b.length){return a.length-b.length}}else if(a[i]<b[i]){return-1}else if(a[i]>b[i]){return 1}}}).map(k=>{s[k.replace("[END]","").replace("[END] ","").replace("[START]","").replace("[START] ","")]=o[k]});return s};jQuery(function(){$("#loader").fadeOut();$("img").on("dragstart",function(e){e.preventDefault();return false});window.onresize();$.ajax({dataType:"json",type:"GET",cache:false,url:"assets/device/list.json",success:function(list){let query=getQuery("device"),total=0;$("#device_list").html("");$.each(sortObject(list),function(k,v){if(v.disabled){return true}let brand=$('<div class="mdui-collapse-item"><div class="mdui-collapse-item-header mdui-list-item mdui-ripple">'+getLogo(v.logo)+'<div class="mdui-list-item-content">'+k+'</div><i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i></div><div class="mdui-collapse-item-body mdui-list"></div></div>');$.each(sortObject(v.device),function(code,config){if(config.disabled){return true}let device=$('<a class="mdui-list-item mdui-ripple">'+config.name.join(" / ")+'<br/><small>'+code+'</small></a>');total++;device.on("click",function(){$.ajax({dataType:"text",type:"GET",cache:false,url:config.config,success:function(device){history.replaceState(null,null,"?device="+k.toLowerCase()+"/"+code);$("#device_data").html(device);$("#device_window").attr("src","device.html");$("#device_window").show();$(".panel-select-device").hide()},error:function(msg){mdui.snackbar(getTranslation("DOWNLOAD_CENTER_TIPS_CONFIG_LOAD_FAIL"))}});closeDownloadDrawer()});if(typeof query==="string"&&query.toLowerCase()===k.toLowerCase()+"/"+code.toLowerCase()){query="";device.click()}brand.children(".mdui-list").append(device)});$("#device_list").append(brand);mdui.mutation()});console.log("Device list loaded! Total devices: "+total)},error:function(msg){mdui.snackbar(getTranslation("DOWNLOAD_CENTER_TIPS_LIST_LOAD_FAIL"));$("#device_list").html(getTranslation("DOWNLOAD_CENTER_TIPS_LIST_LOAD_FAIL"))}})});window.onresize=function(){let a=$("#download-page>div.device-container>div");let b=a.children("img");if(a.height()>=$(window).height()-56){a.css("top","0");a.css("transform","translate(-50%)");b.css("height","200px")}else if($(window).height()>500){a.css("top","50%");a.css("transform","translate(-50%, -50%)");if($(window).width()>500){b.css("height","300px")}else{b.css("height","200px")}}};