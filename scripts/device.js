/*! KaleidoscopeOS Devices v1.0.9 | Copyright © 2002-2023 MlgmXyysd, © 2013-2023 MeowCat Studio, © 2020-2023 Meow Mobile All Rights Reserved */
"use strict";console.log("KaleidoscopeOS Devices v1.0.9");if(self===top){document.body.innerHTML='<span style="color: black;">Access Violation</span>';history.replaceState(null,null,"download.html");setTimeout(function(){window.location="download.html"},500);throw new Error("Access Violation");};const getRandomID=function(length=32){let chars="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r="";for(let i=1;i<=length;i++){r+=chars.substr(Math.floor(Math.random()*chars.length),1)}return r};const doChangeTabBar=function(){$(".mdui-tab-indicator").each(function(){$(this).css({"width":$(this).siblings("a.mdui-tab-active")[0].clientWidth,"left":$(this).siblings("a.mdui-tab-active").position().left})})};const isJSON=function(str){if(typeof str==="string"){try{let obj=JSON.parse(str);if(typeof obj==="object"&&obj){return true}else{return false}}catch(e){return false}}else{return false}};const getDeviceType=function(type){switch(parseInt(type)){case 0:return getTranslation("DEVICES_DEVICE_TYPE_NONAB");case 1:return getTranslation("DEVICES_DEVICE_TYPE_AB");case 2:return getTranslation("DEVICES_DEVICE_TYPE_VIRTUALAB");case 3:return getTranslation("DEVICES_DEVICE_TYPE_GENERIC");default:return getTranslation("DEVICES_DEVICE_TYPE_UNKNOWN")}};const getAndroidVersion=function(api){let version="Android ";switch(parseInt(api)){case 34:version+="14 Upside Down Cake";break;case 33:version+="13 Tiramisu";break;case 32:version+="12L Snow Cone";break;case 31:version+="12 Snow Cone";break;case 30:version+="11 Red Velvet Cake";break;case 29:version+="10 Quince Tart";break;case 28:version+="9 Pie";break;case 27:version+="8.1 Oreo";break;case 26:version+="8.0 Oreo";break;case 25:version+="7.1 Nougat";break;case 24:version+="7.0 Nougat";break;case 23:version+="6 Marshmallow";break;case 22:version+="5.1 Lollipop";break;case 21:version+="5.0 Lollipop";break;case 20:version+="4.4W KitKat";break;case 19:version+="4.4 KitKat";break;case 18:version+="4.3 Jelly Bean";break;case 17:version+="4.2 Jelly Bean";break;case 16:version+="4.1 Jelly Bean";break;case 15:case 14:version+="4.0 Ice Cream Sandwich";break;case 13:version+="3.2 Honeycomb";break;case 12:version+="3.1 Honeycomb";break;case 11:version+="3.0 Honeycomb";break;case 10:case 9:version+="2.3 Gingerbread";break;case 8:version+="2.2 Froyo";break;case 7:version+="2.1 Eclair";break;case 6:case 5:version+="2.0 Eclair";break;case 4:version+="1.6 Donut";break;case 3:version+="1.5 Cupcake";break;case 2:version+="1.1 Petit Four";break;case 1:version+="1.0 Base";break;default:version+=getTranslation("DEVICES_ANDROID_VERSION_UNKNOWN");break}return version};const getDateFromTimetamp=function(timestamp){if(timestamp.toString().length!==new Date().getTime().toString().length){timestamp*=Math.pow(10,new Date().getTime().toString().length-timestamp.toString().length)}timestamp=new Date(timestamp);return timestamp.getFullYear()+"-"+(timestamp.getMonth()+1).toString().padStart(2,"0")+"-"+timestamp.getDate().toString().padStart(2,"0")};const getFirmwareList=function(firmware){if(Object.keys(firmware).length===0){return"• "+getTranslation("DEVICES_FIRMWARE_UNKNOWN")}let list="";$.each(sortObject(firmware),function(k,v){if(v!==""){list+='• <a href="'+v+'" target="_blank">'+k+'</a><br/>'}else{list+='• '+k+'<br/>'}});return list.substring(0,list.length-5)};const getContactList=function(contact){let list="";$.each(sortObject(contact),function(k,v){if(v!==""){list+='<a href="'+v+'" target="_blank"><button class="mdui-btn mdui-ripple">'+k+' <i class="mdui-icon material-icons">chevron_right</i></button></a>'}});return list};const getFileSize=function(byteSize){if(byteSize<1024){return byteSize+" B"}else if(byteSize<Math.pow(1024,2)){return(byteSize/1024).toFixed(2)+" KB"}else if(byteSize<Math.pow(1024,3)){return(byteSize/Math.pow(1024,2)).toFixed(2)+" MB"}else if(byteSize<Math.pow(1024,4)){return(byteSize/Math.pow(1024,3)).toFixed(2)+" GB"}else if(byteSize<Math.pow(1024,5)){return(byteSize/Math.pow(1024,4)).toFixed(2)+" TB"}else{return byteSize+" B"}};const getDownloadLink=function(server,key,extension){switch(parseInt(server)){case 0:return key;case 1:return"https://api.meowcat.top/fileload/"+key+"."+extension;case 2:return"https://otafs1-auto.kscope.ink/fileload/v1/"+key+"."+extension;default:return""}};const getFileList=function(file,type){if(Object.keys(file).length===0){return'<p class="banner">'+getTranslation("DEVICES_FILES_EMPTY")+'</p>'}let tabList=$('<div class="mdui-tab mdui-tab-scrollable" mdui-tab></div>');let list="";$.each(sortObject(file),function(k,v){if(v.disabled){return true}let id=getRandomID();tabList.append($('<a href="#download-'+id+'" class="mdui-btn mdui-ripple mdui-ripple-white">'+k+'</a>'));list+='<div id="download-'+id+'"><div class="version-info">';if(parseInt(type)===1){list+='<div class="mdui-card"><div class="mdui-card-header"><i class="mdui-icon material-icons mdui-card-header-avatar">warning</i><div class="mdui-card-header-title">'+getTranslation("DEVICES_FILES_WARNING_TITLE")+'</div></div><div class="mdui-card-content">'+getTranslation("DEVICES_FILES_WARNING_DEPRECATED")+'</div></div>'}else if(parseInt(type)===2){list+='<div class="mdui-card"><div class="mdui-card-header"><i class="mdui-icon material-icons mdui-card-header-avatar">warning</i><div class="mdui-card-header-title">'+getTranslation("DEVICES_FILES_WARNING_TITLE")+'</div></div><div class="mdui-card-content">'+getTranslation("DEVICES_FILES_WARNING_UNSUPPORTED")+'</div></div>'}list+='<div class="info"><span class="title">'+getTranslation("DEVICES_FILES_INFO_NAME")+'</span><span class="content">'+v.name+'.'+v.extension+'</span></div><div class="info"><span class="title">'+getTranslation("DEVICES_FILES_INFO_TYPE")+'</span><span class="content">'+v.type+'</span></div><div class="info"><span class="title">'+getTranslation("DEVICES_FILES_INFO_SIZE")+'</span><span class="content">'+getFileSize(v.size)+' ('+v.size+')</span></div><div class="info"><span class="title">'+getTranslation("DEVICES_FILES_INFO_HASH")+' <button class="mdui-btn mdui-btn-icon mdui-btn-dense mdui-ripple copy-to-clipboard" data-clipboard-target="#download-'+id+'-hash" mdui-tooltip="{content: \''+getTranslation("DEVICES_FILES_INFO_TIPS_COPY")+'\'}"><i class="mdui-icon material-icons">content_copy</i></button></span><span class="content file-hash" id="download-'+id+'-hash">'+v.hash+'</span></div><a href="'+getDownloadLink(v.server,v.key,v.extension)+'" target="_blank"><button class="mdui-btn-radius mdui-ripple mdui-btn-raised file-download-btn"><i class="mdui-icon material-icons">file_download</i> '+getTranslation("DEVICES_FILES_INFO_BTN_DOWNLOAD")+'</button></a></div></div>'});return tabList.prop("outerHTML")+list};const getMaintainInfo=function(maintain){let info="";if(Object.keys(maintain.maintainer).length===0){info+=getTranslation("DEVICES_MAINTAIN_MAINTAINER_UNKNOWN")}else{info+='<span mdui-tooltip="{content: \'';$.each(sortObject(maintain.maintainer),function(id,name){if(name===""){info+=id}else{if(name!==id){info+=name+" ("+id+")"}else{info+=name}}info+="<br/>"});info=info.substring(0,info.length-5)+'\'}">';let mId=Object.keys(maintain.maintainer)[0];let mName=maintain.maintainer[mId];info+=(Object.keys(maintain.maintainer).length>1?(mName===""?mId:mName)+"...":(mName===""?mId:(mName!==mId?mName+" ("+mId+")":mName)))+"</span>"}info+=" / ";switch(parseInt(maintain.type)){case 0:info+=getTranslation("DEVICES_MAINTAIN_TYPE_OFFICIAL");break;case 1:info+=getTranslation("DEVICES_MAINTAIN_TYPE_COMMERCIAL");break;case 2:info+=getTranslation("DEVICES_MAINTAIN_TYPE_UNSUPPORTED");break;case 3:info+=getTranslation("DEVICES_MAINTAIN_TYPE_COMMUNITY");break;case 4:info+=getTranslation("DEVICES_MAINTAIN_TYPE_UNOFFICIAL");break;default:info+=getTranslation("DEVICES_MAINTAIN_TYPE_UNKNOWN");break}info+=" / ";switch(parseInt(maintain.state)){case 0:info+=getTranslation("DEVICES_MAINTAIN_STATE_ACTIVE");break;case 1:info+=getTranslation("DEVICES_MAINTAIN_STATE_DISCONTINUED");break;case 2:info+=getTranslation("DEVICES_MAINTAIN_STATE_SUSPENDED");break;case 3:info+=getTranslation("DEVICES_MAINTAIN_STATE_PENDING");break;default:info+=getTranslation("DEVICES_MAINTAIN_STATE_UNKNOWN");break}return info};const getFormattedLog=function(log){let format="";if(log.description===""&&Object.keys(log.detail).length===0){format='<p class="banner">'+getTranslation("DEVICES_LOGS_EMPTY")+'</p>'}else{if(log.description!==""){format+='<p class="banner">'+log.description+'</p>'}if(Object.keys(log.detail).length!==0){$.each(log.detail,function(k,v){format+="<p><b>"+k+"</b></p>";$.each(v,function(i,l){format+="<p>• "+l+"</p>"})});format+='<div class="end"></div>'}}return format};const sortObject=function(o){const s={};Object.keys(o).sort((a,b)=>{if(a.startsWith("[END]")&&b.startsWith("[END]")){a=a.replace("[END]","").replace("[END] ","");b=b.replace("[END]","").replace("[END] ","")}else if(a.startsWith("[END]")&&!b.startsWith("[END]")){return 1}else if(!a.startsWith("[END]")&&b.startsWith("[END]")){return-1}else if(a.startsWith("[START]")&&b.startsWith("[START]")){a=a.replace("[START]","").replace("[START] ","");b=b.replace("[START]","").replace("[START] ","")}else if(a.startsWith("[END]")&&!b.startsWith("[START]")){return-1}else if(!a.startsWith("[START]")&&b.startsWith("[START]")){return 1}for(let i=0;i<a.length&&i<b.length;i++){if(a[i]===b[i]){if(i+1===a.length||i+1===b.length){return a.length-b.length}}else if(a[i]<b[i]){return-1}else if(a[i]>b[i]){return 1}}}).map(k=>{s[k.replace("[END]","").replace("[END] ","").replace("[START]","").replace("[START] ","")]=o[k]});return s};jQuery(function(){$("img").on("dragstart",function(e){e.preventDefault();return false});doChangeTabBar();if(self!==top){let device_data;device_data=$("#device_data",parent.document).html();if(!isJSON(device_data)){window.parent.mdui.snackbar(getTranslation("DEVICES_TIPS_CONFIG_LOAD_FAIL"));window.parent.closeDeviceWindow();return}device_data=JSON.parse(device_data);let device_card=$('<div class="mdui-card device-card"><div class="mdui-row device"></div></div>');device_card.children(".device").append('<div class="device-image mobile"><div class="mdui-card-media"><div class="mdui-col-sm-12 mdui-col-md-5"><div class="img"><img style="height:500px;" src="'+device_data.image+'" onerror="this.style.height=\'\';this.parentNode.style.height=\'500px\';this.onerror=\'\';this.src=\'\';" onload="this.style.height=\'\';"/></div><div class="mdui-card-media-covered"><div class="mdui-card-primary"><div class="mdui-card-primary-title">'+device_data.name.join(" / ")+'</div><div class="mdui-card-primary-subtitle">'+device_data.brand+' / <span mdui-tooltip="{content: \''+device_data.code.join("<br/>")+'\'}">'+device_data.code[0]+'</span> / <span mdui-tooltip="{content: \''+device_data.chip.join("<br/>")+'<br/>'+device_data.arch+'\'}">'+device_data.chip[0]+'</span> / '+getDeviceType(device_data.type)+'</div><div class="mdui-card-primary-subtitle">'+getMaintainInfo(device_data.maintain)+'</div></div></div></div></div></div>');let version_info=$('<div class="mdui-col-sm-12 mdui-col-md-6 device-info"><div class="mdui-tab mdui-tab-scrollable" mdui-tab></div></div>');$.each(device_data.version,function(k,v){if(v.disabled){return true}let id=getRandomID();let tab=$('<a href="#version-'+id+'" class="mdui-btn mdui-ripple mdui-ripple-white">'+k+'</a>');tab.on("click",function(){$(".device-more").children(".download").html('<h1>'+getTranslation("DEVICES_TITLE_DOWNLOADS")+'</h1>'+getFileList(v.file,v.type));$(".device-more").children(".changelog").html('<h1>'+getTranslation("DEVICES_TITLE_CHANGELOGS")+'</h1>'+getFormattedLog(v.log));$(".device-more").children(".help").html('<h1>'+getTranslation("DEVICES_TITLE_CONTACTS")+'</h1><a href="https://t.me/KaleidoscopeOS" target="_blank"><button class="mdui-btn mdui-ripple">'+getTranslation("DEVICES_CONTACTS_BTN_MAINHELP")+' <i class="mdui-icon material-icons">chevron_right</i></button></a>'+getContactList(v.contact)+'');mdui.mutation()});version_info.children(".mdui-tab").append(tab);version_info.append($('<div id="version-'+id+'"><div class="version-info"><div class="info"><span class="title">'+getTranslation("DEVICES_VERSIONS_TITLE_VERSION")+'</span><span class="content">'+k+' '+v.name+' ('+getAndroidVersion(v.api)+')</span></div><div class="info"><span class="title">'+getTranslation("DEVICES_VERSIONS_TITLE_TIME")+'</span><span class="content">'+getDateFromTimetamp(v.date)+'</span></div><div class="info"><span class="title">'+getTranslation("DEVICES_VERSIONS_TITLE_PATCH")+'</span><span class="content">'+(v.patch===""?"1970-01-01":v.patch)+'</span></div><div class="info"><span class="title">'+getTranslation("DEVICES_VERSIONS_TITLE_ARCH")+'</span><span class="content">'+(v.arch===""?getTranslation("DEVICES_VERSIONS_ARCH_UNKNOWN"):v.arch)+'</span></div><div class="info"><span class="title">'+getTranslation("DEVICES_VERSIONS_TITLE_MODEL")+'</span><span class="content">'+(v.model.length===0?getTranslation("DEVICES_VERSIONS_MODEL_UNKNOWN"):v.model.join(", "))+'</span></div><div class="info"><span class="title">'+getTranslation("DEVICES_VERSIONS_TITLE_FIRMWARE")+'</span><span class="content">'+getFirmwareList(v.firmware)+'</span></div><div class="info"><span class="title">'+getTranslation("DEVICES_VERSIONS_TIPS_BACKUP")+'</span></div></div></div>'))});device_card.children(".device").append(version_info);let device_more=$('<div class="device-more"><div class="mdui-divider"></div><div class="download"><h1>'+getTranslation("DEVICES_TITLE_DOWNLOADS")+'</h1></div><div class="mdui-divider"></div><div class="changelog"><h1>'+getTranslation("DEVICES_TITLE_CHANGELOGS")+'</h1></div><div class="mdui-divider"></div><div class="help"><h1>'+getTranslation("DEVICES_TITLE_CONTACTS")+'</h1><a href="https://t.me/KaleidoscopeOS" target="_blank"><button class="mdui-btn mdui-ripple">Find help online <i class="mdui-icon material-icons">chevron_right</i></button></a></div></div>');device_card.append(device_more);$("#device_container").append(device_card);let clipboard=new ClipboardJS(".copy-to-clipboard");clipboard.on("success",function(e){window.parent.mdui.snackbar(getTranslation("DEVICES_TIPS_COPY_SUCCESS"));e.clearSelection()});clipboard.on("error",function(e){window.parent.mdui.snackbar(getTranslation("DEVICES_TIPS_COPY_FAIL"))});mdui.mutation();$(".device-info").children(".mdui-tab").children("a")[0].click()}});$(window).resize(function(){setTimeout(function(){doChangeTabBar()},200)});