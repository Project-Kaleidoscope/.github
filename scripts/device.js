/*! KaleidoscopeOS Devices v1.0.5 | Copyright © 2002-2023 MlgmXyysd, © 2013-2023 MeowCat Studio, © 2020-2023 Meow Mobile All Rights Reserved */
"use strict";console.log("KaleidoscopeOS Devices v1.0.5");if(self===top){document.body.innerHTML='<span style="color:black;">Access Violation</span>';history.replaceState(null,null,"download.html");setTimeout(function(){window.location="download.html"},500);throw new Error("Access Violation");};const getRandomID=function(length=32){let chars="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r="";for(let i=1;i<=length;i++){r+=chars.substr(Math.floor(Math.random()*chars.length),1)}return r};const doChangeTabBar=function(){$(".mdui-tab-indicator").each(function(){$(this).css({"width":$(this).siblings("a.mdui-tab-active")[0].clientWidth,"left":$(this).siblings("a.mdui-tab-active").position().left})})};const isJSON=function(str){if(typeof str==="string"){try{let obj=JSON.parse(str);if(typeof obj==="object"&&obj){return true}else{return false}}catch(e){return false}}else{return false}};const getDeviceType=function(type){switch(parseInt(type)){case 0:return"Non-A/B";case 1:return"A/B";case 2:return"Virtual-A/B";default:return"Unknown"}};const getAndroidVersion=function(api){let version="Android ";switch(parseInt(api)){case 34:version+="14 Upside Down Cake";break;case 33:version+="13 Tiramisu";break;case 32:version+="12L Snow Cone";break;case 31:version+="12 Snow Cone";break;case 30:version+="11 Red Velvet Cake";break;case 29:version+="10 Quince Tart";break;case 28:version+="9 Pie";break;case 27:version+="8.1 Oreo";break;case 26:version+="8.0 Oreo";break;case 25:version+="7.1 Nougat";break;case 24:version+="7.0 Nougat";break;case 23:version+="6 Marshmallow";break;case 22:version+="5.1 Lollipop";break;case 21:version+="5.0 Lollipop";break;case 20:version+="4.4W KitKat";break;case 19:version+="4.4 KitKat";break;case 18:version+="4.3 Jelly Bean";break;case 17:version+="4.2 Jelly Bean";break;case 16:version+="4.1 Jelly Bean";break;case 15:case 14:version+="4.0 Ice Cream Sandwich";break;case 13:version+="3.2 Honeycomb";break;case 12:version+="3.1 Honeycomb";break;case 11:version+="3.0 Honeycomb";break;case 10:case 9:version+="2.3 Gingerbread";break;case 8:version+="2.2 Froyo";break;case 7:version+="2.1 Eclair";break;case 6:case 5:version+="2.0 Eclair";break;case 4:version+="1.6 Donut";break;case 3:version+="1.5 Cupcake";break;case 2:version+="1.1 Petit Four";break;case 1:version+="1.0 Base";break;default:version+="Unknown";break}return version};const getDateFromTimetamp=function(timestamp){if(timestamp.toString().length!==new Date().getTime().toString().length){timestamp*=Math.pow(10,new Date().getTime().toString().length-timestamp.toString().length)}timestamp=new Date(timestamp);return timestamp.getFullYear()+"-"+(timestamp.getMonth()+1).toString().padStart(2,"0")+"-"+timestamp.getDate().toString().padStart(2,"0")};const getFirmwareList=function(firmware){if(Object.keys(firmware).length===0){return"• Unknown"}let list="";$.each(firmware,function(k,v){if(v!==""){list+='• <a href="'+v+'" target="_blank">'+k+'</a><br/>'}else{list+='• '+k+'<br/>'}});return list.substring(0,list.length-5)};const getContactList=function(contact){let list="";$.each(contact,function(k,v){if(v!==""){list+='<a href="'+v+'" target="_blank"><button class="mdui-btn mdui-ripple">'+k+' <i class="mdui-icon material-icons">chevron_right</i></button></a>'}});return list};const getFileSize=function(byteSize){if(byteSize<1024){return byteSize+" B"}else if(byteSize<Math.pow(1024,2)){return(byteSize/1024).toFixed(2)+" KB"}else if(byteSize<Math.pow(1024,3)){return(byteSize/Math.pow(1024,2)).toFixed(2)+" MB"}else if(byteSize<Math.pow(1024,4)){return(byteSize/Math.pow(1024,3)).toFixed(2)+" GB"}else if(byteSize<Math.pow(1024,5)){return(byteSize/Math.pow(1024,4)).toFixed(2)+" TB"}else{return byteSize+" B"}};const getDownloadLink=function(server,key,extension){switch(parseInt(server)){case 0:return key;case 1:return"https://api.meowcat.top/fileload/"+key+"."+extension;case 2:return"https://otafs1-auto.kscope.ink/fileload/v1/"+key+"."+extension;default:return""}};const getFileList=function(file,type){if(Object.keys(file).length===0){return'<p class="banner">This version has no file available.</p>'}let tabList=$('<div class="mdui-tab mdui-tab-scrollable" mdui-tab></div>');let list="";$.each(file,function(k,v){if(v.disabled){return true}let id=getRandomID();tabList.append($('<a href="#download-'+id+'" class="mdui-btn mdui-ripple mdui-ripple-white">'+k+'</a>'));list+='<div id="download-'+id+'"><div class="version-info">';if(parseInt(type)===1){list+='<div class="mdui-card"><div class="mdui-card-header"><i class="mdui-icon material-icons mdui-card-header-avatar">warning</i><div class="mdui-card-header-title">WARNING</div></div><div class="mdui-card-content">This release is no longer maintained and is deprecated. We do not provide any type of support for this release.</div></div>'}list+='<div class="info"><span class="title">File Name</span><span class="content">'+v.name+'.'+v.extension+'</span></div><div class="info"><span class="title">Type</span><span class="content">'+v.type+'</span></div><div class="info"><span class="title">Size</span><span class="content">'+getFileSize(v.size)+' ('+v.size+')</span></div><div class="info"><span class="title">MD5 <button class="mdui-btn mdui-btn-icon mdui-btn-dense mdui-ripple copy-to-clipboard" data-clipboard-target="#download-'+id+'-hash" mdui-tooltip="{content: \'Copy to clipboard\'}"><i class="mdui-icon material-icons">content_copy</i></button></span><span class="content file-hash" id="download-'+id+'-hash">'+v.hash+'</span></div><a href="'+getDownloadLink(v.server,v.key,v.extension)+'" target="_blank"><button class="mdui-btn-radius mdui-ripple mdui-btn-raised file-download-btn"><i class="mdui-icon material-icons">file_download</i> Download</button></a></div></div>'});return tabList.prop("outerHTML")+list};const getMaintainInfo=function(maintain){let info="";if(Object.keys(maintain.maintainer).length===0){info+="Unknown"}else{$.each(maintain.maintainer,function(id,name){if(name===""){info+=id}else{if(name!==id){info+=name+" ("+id+")"}else{info+=name}}info+=" & "});info=info.substring(0,info.length-3)}switch(parseInt(maintain.type)){case 0:info+=" / Official";break;default:info+=" / Unknown";break}switch(parseInt(maintain.state)){case 0:info+=" / Active";break;case 1:info+=" / Discontinued";break;case 2:info+=" / Suspended";break;case 3:info+=" / Pending";break;default:info+=" / Unknown";break}return info};const getFormattedLog=function(log){let format="";if(log.description===""&&Object.keys(log.detail).length===0){format='<p class="banner">This version has no update log available.</p>'}else{if(log.description!==""){format+='<p class="banner">'+log.description+'</p>'}if(Object.keys(log.detail).length!==0){$.each(log.detail,function(k,v){format+="<p><b>"+k+"</b></p>";$.each(v,function(i,l){format+="<p>• "+l+"</p>"})});format+='<div class="end"></div>'}}return format};jQuery(function(){$("img").on("dragstart",function(e){e.preventDefault();return false});doChangeTabBar();if(self!==top){let device_data;device_data=$("#device_data",parent.document).html();if(!isJSON(device_data)){window.parent.mdui.snackbar("Error when parsing device data.");window.parent.closeDeviceWindow();return}device_data=JSON.parse(device_data);let device_card=$('<div class="mdui-card device-card"><div class="mdui-row device"></div></div>');device_card.children(".device").append('<div class="device-image mobile"><div class="mdui-card-media"><div class="mdui-col-sm-12 mdui-col-md-5"><div class="img" style="background-image: url('+device_data.image+');"/><div class="mdui-card-media-covered"><div class="mdui-card-primary"><div class="mdui-card-primary-title">'+device_data.name.join(" / ")+'</div><div class="mdui-card-primary-subtitle">'+device_data.brand+' / <span mdui-tooltip="{content: \''+device_data.code.join("<br/>")+'\'}">'+device_data.code[0]+'</span> / <span mdui-tooltip="{content: \''+device_data.chip.join("<br/>")+'<br/>'+device_data.arch+'\'}">'+device_data.chip[0]+'</span> / '+getDeviceType(device_data.type)+'</div><div class="mdui-card-primary-subtitle">'+getMaintainInfo(device_data.maintain)+'</div></div></div></div></div></div>');let version_info=$('<div class="mdui-col-sm-12 mdui-col-md-6 device-info"><div class="mdui-tab mdui-tab-scrollable" mdui-tab></div></div>');$.each(device_data.version,function(k,v){if(v.disabled){return true}let id=getRandomID();let tab=$('<a href="#version-'+id+'" class="mdui-btn mdui-ripple mdui-ripple-white">'+k+'</a>');tab.on("click",function(){$(".device-more").children(".download").html('<h1>Download</h1>'+getFileList(v.file,v.type));$(".device-more").children(".changelog").html('<h1>What\'s new?</h1>'+getFormattedLog(v.log));$(".device-more").children(".help").html('<h1>Need help?</h1><a href="https://t.me/KaleidoscopeOS" target="_blank"><button class="mdui-btn mdui-ripple">Find help online <i class="mdui-icon material-icons">chevron_right</i></button></a>'+getContactList(v.contact)+'');mdui.mutation()});version_info.children(".mdui-tab").append(tab);version_info.append($('<div id="version-'+id+'"><div class="version-info"><div class="info"><span class="title">Version</span><span class="content">'+k+' '+v.name+' ('+getAndroidVersion(v.api)+')</span></div><div class="info"><span class="title">Updated on</span><span class="content">'+getDateFromTimetamp(v.date)+'</span></div><div class="info"><span class="title">Security Patch</span><span class="content">'+(v.patch===""?"1970-01-01":v.patch)+'</span></div><div class="info"><span class="title">System Architecture</span><span class="content">'+(v.arch===""?"Unknown":v.arch)+'</span></div><div class="info"><span class="title">Supported Model</span><span class="content">'+(v.model.length===0?"Unknown":v.model.join(", "))+'</span></div><div class="info"><span class="title">Supported Base Firmware</span><span class="content">'+getFirmwareList(v.firmware)+'</span></div><div class="info"><span class="title">Please back up your data before flashing your device.</span></div></div></div>'))});device_card.children(".device").append(version_info);let device_more=$('<div class="device-more"><div class="mdui-divider"></div><div class="download"><h1>Download</h1></div><div class="mdui-divider"></div><div class="changelog"><h1>What\'s new?</h1></div><div class="mdui-divider"></div><div class="help"><a href="https://t.me/KaleidoscopeOS" target="_blank"><button class="mdui-btn mdui-ripple">Find help online <i class="mdui-icon material-icons">chevron_right</i></button></a></div></div>');device_card.append(device_more);$("#device_container").append(device_card);let clipboard=new ClipboardJS(".copy-to-clipboard");clipboard.on("success",function(e){window.parent.mdui.snackbar("Copied to clipboard.");e.clearSelection()});clipboard.on("error",function(e){window.parent.mdui.snackbar("Failed to copy to clipboard.")});mdui.mutation();$(".device-info").children(".mdui-tab").children("a")[0].click()}});$(window).resize(function(){setTimeout(function(){doChangeTabBar()},200)});